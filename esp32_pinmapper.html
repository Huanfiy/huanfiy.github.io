<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32-S3 ÂºïËÑöÊò†Â∞ÑÂô®</title>
    <link rel="icon" type="image/png" href="picture/icon.png">
    <style>
        :root {
            --main-bg-color: #f5f5f5;
            --dark-bg-color: #1e1e1e;
            --main-text-color: #333;
            --dark-text-color: #f0f0f0;
            --chip-bg-color: #2c2c2c;
            --dark-chip-bg-color: #121212;
            --pin-default-color: #7a7a7a; /* ÁÅ∞Ëâ≤ */
            --pin-configured-color: #4CAF50; /* ÁªøËâ≤ */
            --power-pin-color: #ff5252; /* Á∫¢Ëâ≤ */
            --ground-pin-color: #2196F3; /* ËìùËâ≤ */
            --special-pin-color: #E040FB; /* Á¥´Ëâ≤ */
            --hover-color: #f0f0f0;
            --dark-hover-color: #3a3a3a;
            --border-color: #ddd;
            --dark-border-color: #444;
            --panel-bg-color: white;
            --dark-panel-bg-color: #2a2a2a;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--main-bg-color);
            color: var(--main-text-color);
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode {
            background-color: var(--dark-bg-color);
            color: var(--dark-text-color);
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
        }

        h1 {
            margin-bottom: 5px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 20px;
        }

        .dark-mode .subtitle {
            color: #aaa;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .chip-container {
            width: 100%;
            max-width: 800px;
            margin-bottom: 30px;
            position: relative;
        }

        #chipSvg {
            display: block;
            margin: 0 auto;
            max-width: 100%;
        }

        .info-panel {
            background-color: var(--panel-bg-color);
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 500px;
            max-width: 90%;
            margin-top: 20px;
        }

        .dark-mode .info-panel {
            background-color: var(--dark-panel-bg-color);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .panel-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin: 0;
        }

        .search-container {
            display: flex;
            margin-bottom: 15px;
        }

        input[type="text"], input[type="file"] {
            flex-grow: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
        }

        .dark-mode input[type="text"], .dark-mode input[type="file"] {
            background-color: #333;
            color: white;
            border-color: var(--dark-border-color);
        }

        .info-content {
            max-height: 300px;
            overflow-y: auto;
        }

        .pin-detail {
            border-left: 3px solid #4CAF50;
            padding-left: 10px;
            margin-bottom: 12px;
        }

        .pin-detail h3 {
            margin: 0 0 8px 0;
            font-size: 1.1rem;
        }

        .pin-detail p {
            margin: 4px 0;
            font-size: 0.95rem;
        }

        .label {
            font-weight: bold;
            display: inline-block;
            min-width: 100px;
        }

        .config-status {
            margin-top: 10px;
            padding: 8px;
            border-radius: 4px;
            background-color: #f0f0f0;
            font-size: 0.9rem;
        }

        .dark-mode .config-status {
            background-color: #333;
        }

        .pin-type {
            display: inline-block;
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 0.8rem;
            color: white;
            margin-right: 5px;
        }

        .pin-type.power {
            background-color: var(--power-pin-color);
        }

        .pin-type.ground {
            background-color: var(--ground-pin-color);
        }

        .pin-type.io {
            background-color: var(--pin-configured-color);
        }

        .pin-type.special {
            background-color: var(--special-pin-color);
        }

        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-right: 15px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 20px;
        }

        .toolbar-group {
            display: flex;
        }

        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
            margin: 0 5px;
        }

        button:hover {
            background-color: #3e8e41;
        }

        button.secondary {
            background-color: #2196F3;
        }

        button.secondary:hover {
            background-color: #0b7dda;
        }

        button.danger {
            background-color: #f44336;
        }

        button.danger:hover {
            background-color: #d32f2f;
        }

        .dark-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: transparent;
            border: none;
            color: inherit;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
        }

        .dark-toggle i {
            margin-right: 5px;
        }

        #fileInput {
            display: none;
        }

        /* SVGÊ†∑Âºè */
        .chip-body {
            transition: fill 0.3s;
        }

        .dark-mode .chip-body {
            fill: var(--dark-chip-bg-color);
        }

        .chip-text {
            transition: fill 0.3s;
        }

        .dark-mode .chip-text {
            fill: white;
        }

        .pin-circle {
            cursor: pointer;
            transition: r 0.2s, stroke-width 0.2s;
        }

        .pin-circle:hover {
            r: 14;
            stroke-width: 2;
            stroke: white;
        }

        /* Â∑•ÂÖ∑ÊèêÁ§∫ */
        .tooltip {
            position: absolute;
            padding: 6px 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            white-space: nowrap;
            z-index: 1000;
        }

        /* ÂäüËÉΩÈÄâÊã©‰∏ãÊãâËèúÂçï */
        .function-selector {
            margin-top: 15px;
            width: 100%;
        }

        select {
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            background-color: white;
        }

        .dark-mode select {
            background-color: #333;
            color: white;
            border-color: var(--dark-border-color);
        }

        .button-group {
            display: flex;
            justify-content: flex-start;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        /* ÂØºÂÖ•ÂØºÂá∫Âå∫Âüü */
        .import-export {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 10px;
        }

        .file-actions {
            display: flex;
            gap: 10px;
        }

        /* ËØÑËÆ∫Âå∫Âüü */
        .comments-section {
            margin-top: 15px;
            width: 100%;
        }

        .comments-section h3 {
            margin-bottom: 10px;
            font-size: 1rem;
        }

        textarea {
            width: 100%;
            min-height: 80px;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            resize: vertical;
            font-family: inherit;
            font-size: 14px;
            box-sizing: border-box;
        }

        .dark-mode textarea {
            background-color: #333;
            color: white;
            border-color: var(--dark-border-color);
        }

        .config-notes {
            margin-top: 5px;
            font-size: 0.9em;
            color: #666;
        }

        .dark-mode .config-notes {
            color: #aaa;
        }

        .project-notes {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: #f9f9f9;
            margin-bottom: 20px;
        }

        .dark-mode .project-notes {
            background-color: #282828;
            border-color: var(--dark-border-color);
        }

        /* ÂìçÂ∫îÂºèË∞ÉÊï¥ */
        @media (max-width: 768px) {
            .info-panel {
                width: 100%;
            }
            
            .button-group, .toolbar, .import-export {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                margin: 5px;
                width: 100%;
            }
            
            .legend {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <button class="dark-toggle" onclick="toggleDarkMode()">
        <i class="mode-icon">üåô</i> ÂàáÊç¢Ê∑±Ëâ≤Ê®°Âºè
    </button>

    <div class="container">
        <header>
            <h1>ESP32-S3 ÂºïËÑöÊò†Â∞ÑÂô®</h1>
            <p class="subtitle">‰∫§‰∫íÂºèÂèØËßÜÂåñÂ∑•ÂÖ∑ÔºåÂ∏ÆÂä©ÊÇ®ÈÖçÁΩÆ ESP32-S3 ÁöÑÂºïËÑöÂäüËÉΩ</p>
        </header>

        <div class="toolbar">
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background-color: var(--pin-default-color);"></div>
                    <span>Êú™ÈÖçÁΩÆ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: var(--pin-configured-color);"></div>
                    <span>Â∑≤ÈÖçÁΩÆ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: var(--power-pin-color);"></div>
                    <span>ÁîµÊ∫ê</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: var(--ground-pin-color);"></div>
                    <span>Êé•Âú∞</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: var(--special-pin-color);"></div>
                    <span>ÁâπÊÆä</span>
                </div>
            </div>
            <div class="toolbar-group">
                <button class="danger" onclick="clearAllConfigurations()">Ê∏ÖÈô§ÊâÄÊúâÈÖçÁΩÆ</button>
            </div>
        </div>

        <!-- È°πÁõÆÁ¨îËÆ∞Âå∫Âüü -->
        <div class="project-notes">
            <h3>È°πÁõÆÁ¨îËÆ∞</h3>
            <textarea id="projectNotes" placeholder="Âú®ËøôÈáåÊ∑ªÂä†ÂÖ≥‰∫éÊï¥‰∏™È°πÁõÆÁöÑÁ¨îËÆ∞„ÄÅËÆæËÆ°ËØ¥ÊòéÊàñÈÖçÁΩÆÂéüÂõ†..." oninput="updateProjectNotes(this.value)"></textarea>
        </div>

        <div class="import-export">
            <button class="secondary" onclick="exportConfig()">ÂØºÂá∫ÈÖçÁΩÆ</button>
            <div class="file-actions">
                <button class="secondary" onclick="document.getElementById('fileInput').click()">ÈÄâÊã©ÈÖçÁΩÆÊñá‰ª∂</button>
                <input type="file" id="fileInput" accept=".json" onchange="handleFileSelect(event)">
            </div>
        </div>

        <div class="main-content">
            <div class="chip-container">
                <svg id="chipSvg" viewBox="0 0 800 800" width="800" height="800">
                    <!-- SVGÂÜÖÂÆπÂ∞ÜÁî±JavaScriptÂä®ÊÄÅÁîüÊàê -->
                </svg>
                <div id="tooltip" class="tooltip"></div>
            </div>

            <div class="info-panel">
                <div class="panel-header">
                    <h2 class="panel-title">ÂºïËÑö‰ø°ÊÅØ</h2>
                </div>
                
                <div class="search-container">
                    <input type="text" id="searchPin" placeholder="ÊêúÁ¥¢ÂºïËÑö (‰æãÂ¶Ç: GPIO1, 3)" onkeyup="searchPins()">
                </div>
                
                <div class="info-content" id="pinInfoContent">
                    <div class="pin-detail">
                        <p>ËØ∑ÈÄâÊã©‰∏Ä‰∏™ÂºïËÑöÊü•ÁúãËØ¶ÁªÜ‰ø°ÊÅØ</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Êõ¥Êñ∞ÂêéÁöÑÂºïËÑöÊï∞ÊçÆÔºåÊ†πÊçÆÂÆòÊñπÂõæÁâá‰øÆÊ≠£
        const pins = [
            // Â∑¶‰æß (‰ªé‰∏äÂà∞‰∏ã)
            { id: 1, name: "LNA_IN", type: 'special', defaultFunction: "LNA_IN", capabilities: ["RF input"] },
            { id: 2, name: "VDD3P3", type: 'power', defaultFunction: "VDD3P3", capabilities: ["3.3V Power"] },
            { id: 3, name: "VDD3P3", type: 'power', defaultFunction: "VDD3P3", capabilities: ["3.3V Power"] },
            { id: 4, name: "CHIP_PU", type: 'special', defaultFunction: "CHIP_PU", capabilities: ["Chip Power Up", "Reset"] },
            { id: 5, name: "GPIO0", type: 'io', defaultFunction: "GPIO0", capabilities: ["GPIO", "Boot mode selection"] },
            { id: 6, name: "GPIO1", type: 'io', defaultFunction: "GPIO1", capabilities: ["GPIO"] },
            { id: 7, name: "GPIO2", type: 'io', defaultFunction: "GPIO2", capabilities: ["GPIO"] },
            { id: 8, name: "GPIO3", type: 'io', defaultFunction: "GPIO3", capabilities: ["GPIO"] },
            { id: 9, name: "GPIO4", type: 'io', defaultFunction: "GPIO4", capabilities: ["GPIO"] },
            { id: 10, name: "GPIO5", type: 'io', defaultFunction: "GPIO5", capabilities: ["GPIO"] },
            { id: 11, name: "GPIO6", type: 'io', defaultFunction: "GPIO6", capabilities: ["GPIO"] },
            { id: 12, name: "GPIO7", type: 'io', defaultFunction: "GPIO7", capabilities: ["GPIO"] },
            { id: 13, name: "GPIO8", type: 'io', defaultFunction: "GPIO8", capabilities: ["GPIO"] },
            { id: 14, name: "GPIO9", type: 'io', defaultFunction: "GPIO9", capabilities: ["GPIO"] },
            
            // Â∫ïÈÉ® (‰ªéÂ∑¶Âà∞Âè≥)
            { id: 15, name: "GPIO10", type: 'io', defaultFunction: "GPIO10", capabilities: ["GPIO"] },
            { id: 16, name: "GPIO11", type: 'io', defaultFunction: "GPIO11", capabilities: ["GPIO"] },
            { id: 17, name: "GPIO12", type: 'io', defaultFunction: "GPIO12", capabilities: ["GPIO"] },
            { id: 18, name: "GPIO13", type: 'io', defaultFunction: "GPIO13", capabilities: ["GPIO"] },
            { id: 19, name: "GPIO14", type: 'io', defaultFunction: "GPIO14", capabilities: ["GPIO"] },
            { id: 20, name: "VDD3P3_RTC", type: 'power', defaultFunction: "VDD3P3_RTC", capabilities: ["3.3V RTC Power"] },
            { id: 21, name: "XTAL_32K_P", type: 'special', defaultFunction: "XTAL_32K_P", capabilities: ["32K Crystal Oscillator P"] },
            { id: 22, name: "XTAL_32K_N", type: 'special', defaultFunction: "XTAL_32K_N", capabilities: ["32K Crystal Oscillator N"] },
            { id: 23, name: "GPIO17", type: 'io', defaultFunction: "GPIO17", capabilities: ["GPIO"] },
            { id: 24, name: "GPIO18", type: 'io', defaultFunction: "GPIO18", capabilities: ["GPIO"] },
            { id: 25, name: "GPIO19", type: 'io', defaultFunction: "GPIO19", capabilities: ["GPIO"] },
            { id: 26, name: "GPIO20", type: 'io', defaultFunction: "GPIO20", capabilities: ["GPIO"] },
            { id: 27, name: "GPIO21", type: 'io', defaultFunction: "GPIO21", capabilities: ["GPIO"] },
            { id: 28, name: "SPICS1", type: 'io', defaultFunction: "SPICS1", capabilities: ["SPI CS1"] },
            
            // Âè≥‰æß (‰ªé‰∏ãÂà∞‰∏ä)
            { id: 29, name: "VDD_SPI", type: 'power', defaultFunction: "VDD_SPI", capabilities: ["SPI Power"] },
            { id: 30, name: "SPIHD", type: 'io', defaultFunction: "SPIHD", capabilities: ["SPI HD"] },
            { id: 31, name: "SPIWP", type: 'io', defaultFunction: "SPIWP", capabilities: ["SPI WP"] },
            { id: 32, name: "SPICS0", type: 'io', defaultFunction: "SPICS0", capabilities: ["SPI CS0"] },
            { id: 33, name: "SPICLK", type: 'io', defaultFunction: "SPICLK", capabilities: ["SPI CLK"] },
            { id: 34, name: "SPIQ", type: 'io', defaultFunction: "SPIQ", capabilities: ["SPI Q"] },
            { id: 35, name: "SPID", type: 'io', defaultFunction: "SPID", capabilities: ["SPI D"] },
            { id: 36, name: "SPICLK_N", type: 'io', defaultFunction: "SPICLK_N", capabilities: ["SPI CLK N"] },
            { id: 37, name: "SPICLK_P", type: 'io', defaultFunction: "SPICLK_P", capabilities: ["SPI CLK P"] },
            { id: 38, name: "GPIO33", type: 'io', defaultFunction: "GPIO33", capabilities: ["GPIO"] },
            { id: 39, name: "GPIO34", type: 'io', defaultFunction: "GPIO34", capabilities: ["GPIO"] },
            { id: 40, name: "GPIO35", type: 'io', defaultFunction: "GPIO35", capabilities: ["GPIO"] },
            { id: 41, name: "GPIO36", type: 'io', defaultFunction: "GPIO36", capabilities: ["GPIO"] },
            { id: 42, name: "GPIO37", type: 'io', defaultFunction: "GPIO37", capabilities: ["GPIO"] },
            
            // È°∂ÈÉ® (‰ªéÂè≥Âà∞Â∑¶)
            { id: 43, name: "GPIO38", type: 'io', defaultFunction: "GPIO38", capabilities: ["GPIO"] },
            { id: 44, name: "MTCK", type: 'special', defaultFunction: "MTCK", capabilities: ["JTAG Test Clock"] },
            { id: 45, name: "MTDO", type: 'special', defaultFunction: "MTDO", capabilities: ["JTAG Test Data Out"] },
            { id: 46, name: "VDD3P3_CPU", type: 'power', defaultFunction: "VDD3P3_CPU", capabilities: ["3.3V CPU Power"] },
            { id: 47, name: "MTDI", type: 'special', defaultFunction: "MTDI", capabilities: ["JTAG Test Data In"] },
            { id: 48, name: "MTMS", type: 'special', defaultFunction: "MTMS", capabilities: ["JTAG Test Mode Select"] },
            { id: 49, name: "U0TXD", type: 'io', defaultFunction: "U0TXD", capabilities: ["UART0 TXD"] },
            { id: 50, name: "U0RXD", type: 'io', defaultFunction: "U0RXD", capabilities: ["UART0 RXD"] },
            { id: 51, name: "GPIO45", type: 'io', defaultFunction: "GPIO45", capabilities: ["GPIO"] },
            { id: 52, name: "GPIO46", type: 'io', defaultFunction: "GPIO46", capabilities: ["GPIO"] },
            { id: 53, name: "XTAL_N", type: 'special', defaultFunction: "XTAL_N", capabilities: ["Crystal Oscillator N"] },
            { id: 54, name: "XTAL_P", type: 'special', defaultFunction: "XTAL_P", capabilities: ["Crystal Oscillator P"] },
            { id: 55, name: "VDDA", type: 'power', defaultFunction: "VDDA", capabilities: ["Analog Power"] },
            { id: 56, name: "VDDA", type: 'power', defaultFunction: "VDDA", capabilities: ["Analog Power"] }
        ];

        // ÂäüËÉΩÂ≠óÂÖ∏Ôºö‰∏∫ÊØè‰∏™ÂºïËÑöÂèØ‰ª•ÈÖçÁΩÆÁöÑÂèØËÉΩÂäüËÉΩ
        const pinFunctions = {
            // GPIOÂºïËÑö
            "GPIO0": ["GPIO0"],
            "GPIO1": ["GPIO1"],
            "GPIO2": ["GPIO2"],
            "GPIO3": ["GPIO3"],
            "GPIO4": ["GPIO4"],
            "GPIO5": ["GPIO5"],
            "GPIO6": ["GPIO6"],
            "GPIO7": ["GPIO7"],
            "GPIO8": ["GPIO8"],
            "GPIO9": ["GPIO9"],
            "GPIO10": ["GPIO10"],
            "GPIO11": ["GPIO11"],
            "GPIO12": ["GPIO12"],
            "GPIO13": ["GPIO13"],
            "GPIO14": ["GPIO14"],    // Êõ¥Â§öGPIOÂºïËÑö...
            "GPIO17": ["GPIO17", "DAC_1"],
            "GPIO18": ["GPIO18", "DAC_2"],
            "GPIO19": ["GPIO19", "USB_D-"],
            "GPIO20": ["GPIO20", "USB_D+"],
            "GPIO21": ["GPIO21"],
            "SPIHD": ["SPIHD", "GPIO27"],
            "SPIWP": ["SPIWP", "GPIO28"],
            "SPICS0": ["SPICS0", "GPIO29"],
            "SPICLK": ["SPICLK", "GPIO30"],
            "SPIQ": ["SPIQ", "GPIO31"],
            "SPID": ["SPID", "GPIO32"],
            "SPICLK_N": ["SPICLK_N", "GPIO48"],
            "SPICLK_P": ["SPICLK_P", "GPIO47"],
            // ÂÖ∂‰ªñGPIO
            "GPIO33": ["GPIO33"],
            "GPIO34": ["GPIO34"],
            "GPIO35": ["GPIO35"],
            "GPIO36": ["GPIO36"],
            "GPIO37": ["GPIO37"],
            "GPIO38": ["GPIO38"],
            // ÁîµÊ∫êÂíåÁâπÊÆäÂºïËÑöÈÄöÂ∏∏Ê≤°ÊúâÂÖ∂‰ªñÂäüËÉΩÈÄâÈ°π
            "LNA_IN": ["LNA_IN"],
            "VDD3P3": ["VDD3P3"],
            "CHIP_PU": ["CHIP_PU"],
            "VDD3P3_RTC": ["VDD3P3_RTC"],
            "XTAL_32K_P": ["XTAL_32K_P"],
            "XTAL_32K_N": ["XTAL_32K_N"],
            "VDD_SPI": ["VDD_SPI"],
            "VDD3P3_CPU": ["VDD3P3_CPU"],
            "MTDI": ["MTDI", "GPIO41"],
            "MTCK": ["MTCK", "GPIO39"],
            "MTMS": ["MTMS", "GPIO42"],
            "MTDO": ["MTDO", "GPIO40"],
            "U0TXD": ["U0TXD", "GPIO43"],
            "U0RXD": ["U0RXD", "GPIO44"],
            "XTAL_N": ["XTAL_N"],
            "XTAL_P": ["XTAL_P"],
            "VDDA": ["VDDA"]
        };

        // ÂºïËÑöÈÖçÁΩÆÁä∂ÊÄÅ
        let pinConfigurations = {};
        
        // ÂºïËÑöËØÑËÆ∫
        let pinComments = {};
        
        // È°πÁõÆÁ¨îËÆ∞
        let projectNotes = "";

        // Êõ¥Êñ∞È°πÁõÆÁ¨îËÆ∞
        function updateProjectNotes(notes) {
            projectNotes = notes;
        }
        
        // ÂàõÂª∫SVGÂÖÉÁ¥†
        function createSvgElements() {
            const svg = document.getElementById('chipSvg');
            const svgNS = "http://www.w3.org/2000/svg";
            
            // ËÉåÊôØÁôΩËâ≤Áü©ÂΩ¢ÔºàÊñπ‰æøÊü•ÁúãÂíåÂØºÂá∫Ôºâ
            const background = document.createElementNS(svgNS, "rect");
            background.setAttribute("x", 0);
            background.setAttribute("y", 0);
            background.setAttribute("width", 800);
            background.setAttribute("height", 800);
            background.setAttribute("fill", "white");
            svg.appendChild(background);
            
            // ËäØÁâá‰∏ª‰Ωì
            const chipBody = document.createElementNS(svgNS, "rect");
            chipBody.setAttribute("x", 150);
            chipBody.setAttribute("y", 150);
            chipBody.setAttribute("width", 500);
            chipBody.setAttribute("height", 500);
            chipBody.setAttribute("rx", 10);
            chipBody.setAttribute("ry", 10);
            chipBody.setAttribute("fill", "#2c2c2c");
            chipBody.setAttribute("stroke", "#000");
            chipBody.setAttribute("stroke-width", "2");
            chipBody.setAttribute("stroke-dasharray", "5,5");
            chipBody.classList.add("chip-body");
            svg.appendChild(chipBody);
            
            // ËäØÁâáÊ†áÁ≠æ
            const chipText = document.createElementNS(svgNS, "text");
            chipText.setAttribute("x", 400);
            chipText.setAttribute("y", 400);
            chipText.setAttribute("text-anchor", "middle");
            chipText.setAttribute("dominant-baseline", "middle");
            chipText.setAttribute("fill", "white");
            chipText.setAttribute("font-size", "36");
            chipText.setAttribute("font-weight", "bold");
            chipText.textContent = "ESP32-S3";
            chipText.classList.add("chip-text");
            svg.appendChild(chipText);
            
            // ÂàõÂª∫ÂºïËÑö
            const pinRadius = 12;
            
            // Â∑¶‰æßÂºïËÑö (‰ªé‰∏äÂà∞‰∏ã)
            for (let i = 0; i < 14; i++) {
                createPin(svg, svgNS, pins[i], 150, 205 + i * 30, "left", pinRadius);
            }
            
            // Â∫ïÈÉ®ÂºïËÑö (‰ªéÂ∑¶Âà∞Âè≥)
            for (let i = 0; i < 14; i++) {
                createPin(svg, svgNS, pins[i+14], 200 + i * 30, 650, "bottom", pinRadius);
            }
            
            // Âè≥‰æßÂºïËÑö (‰ªé‰∏ãÂà∞‰∏ä)
            for (let i = 0; i < 14; i++) {
                createPin(svg, svgNS, pins[i+28], 650, 595 - i * 30, "right", pinRadius);
            }
            
            // È°∂ÈÉ®ÂºïËÑö (‰ªéÂè≥Âà∞Â∑¶)
            for (let i = 0; i < 14; i++) {
                createPin(svg, svgNS, pins[i+42], 595 - i * 30, 150, "top", pinRadius);
            }
            
            // Ê∑ªÂä†GNDÊ†áËÆ∞ (Ê†πÊçÆÂõæÁ§∫Âú®ËäØÁâáÂè≥‰∏ãÈÉ®)
            const gndText = document.createElementNS(svgNS, "text");
            gndText.setAttribute("x", 350);
            gndText.setAttribute("y", 550);
            gndText.setAttribute("fill", "white");
            gndText.setAttribute("font-size", "20");
            gndText.textContent = "57 GND";
            svg.appendChild(gndText);
        }
        
        // ÂàõÂª∫Âçï‰∏™ÂºïËÑö
        function createPin(svg, svgNS, pin, x, y, side, radius) {
            // Á°ÆÂÆöÂºïËÑöÈ¢úËâ≤
            let pinColor;
            if (pin.type === 'power') {
                pinColor = '#ff5252'; // Á∫¢Ëâ≤
            } else if (pin.type === 'ground' && pin.defaultFunction === 'GND') {
                pinColor = '#2196F3'; // ËìùËâ≤
            } else if (pin.type === 'special') {
                pinColor = '#E040FB'; // Á¥´Ëâ≤
            } else {
                pinColor = '#7a7a7a'; // ÁÅ∞Ëâ≤
            }
            
            // ÂàõÂª∫ÂºïËÑöÂúÜÁÇπ
            const pinCircle = document.createElementNS(svgNS, "circle");
            pinCircle.setAttribute("cx", x);
            pinCircle.setAttribute("cy", y);
            pinCircle.setAttribute("r", radius);
            pinCircle.setAttribute("fill", pinColor);
            pinCircle.setAttribute("stroke", "#000");
            pinCircle.setAttribute("stroke-width", "1");
            pinCircle.setAttribute("data-id", pin.id);
            pinCircle.setAttribute("data-name", pin.name);
            pinCircle.classList.add("pin-circle");
            
            // Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
            pinCircle.addEventListener("click", function() {
                selectPin(pin.id);
            });
            
            // Ê∑ªÂä†ÊÇ¨ÂÅúÊèêÁ§∫‰∫ã‰ª∂
            pinCircle.addEventListener("mousemove", function(e) {
                showTooltip(e, `ÂºïËÑö ${pin.id}: ${pin.name} - ${pin.defaultFunction}`);
            });
            
            pinCircle.addEventListener("mouseout", function() {
                hideTooltip();
            });
            
            svg.appendChild(pinCircle);
            
            // ÂàõÂª∫ÂºïËÑöÁõíÂ≠êÔºàËôöÁ∫øËæπÊ°ÜÔºâ
            const pinBox = document.createElementNS(svgNS, "rect");
            let boxX = x, boxY = y, boxWidth = 30, boxHeight = 20;
            
            switch(side) {
                case "left":
                    boxX = x - 45;
                    boxY = y - 10;
                    break;
                case "right":
                    boxX = x + 15;
                    boxY = y - 10;
                    break;
                case "top":
                    boxX = x - 15;
                    boxY = y - 30;
                    break;
                case "bottom":
                    boxX = x - 15;
                    boxY = y + 10;
                    break;
            }
            
            pinBox.setAttribute("x", boxX);
            pinBox.setAttribute("y", boxY);
            pinBox.setAttribute("width", boxWidth);
            pinBox.setAttribute("height", boxHeight);
            pinBox.setAttribute("fill", "none");
            pinBox.setAttribute("stroke", "#666");
            pinBox.setAttribute("stroke-width", "1");
            pinBox.setAttribute("stroke-dasharray", "2,2");
            svg.appendChild(pinBox);
            
            // ÂàõÂª∫ÂºïËÑöÂè∑
            const pinNumber = document.createElementNS(svgNS, "text");
            let textX = 0, textY = 0;
            
            switch(side) {
                case "left":
                    textX = boxX + boxWidth/2;
                    textY = boxY + boxHeight/2 + 5;
                    break;
                case "right":
                    textX = boxX + boxWidth/2;
                    textY = boxY + boxHeight/2 + 5;
                    break;
                case "top":
                    textX = boxX + boxWidth/2;
                    textY = boxY + boxHeight/2 + 5;
                    break;
                case "bottom":
                    textX = boxX + boxWidth/2;
                    textY = boxY + boxHeight/2 + 5;
                    break;
            }
            
            pinNumber.setAttribute("x", textX);
            pinNumber.setAttribute("y", textY);
            pinNumber.setAttribute("text-anchor", "middle");
            pinNumber.setAttribute("fill", "#333");
            pinNumber.setAttribute("font-size", "12");
            pinNumber.textContent = pin.id;
            svg.appendChild(pinNumber);
            
            // Ê∑ªÂä†ÂºïËÑöÂäüËÉΩÂêçÁß∞ÔºàÂú®ËäØÁâáÂ§ñÔºâ
            const pinFunction = document.createElementNS(svgNS, "text");
            let funcX = 0, funcY = 0, rotate = 0;
            
            switch(side) {
                case "left":
                    funcX = x - 60;
                    funcY = y + 5;
                    pinFunction.setAttribute("text-anchor", "end");
                    rotate = 0;
                    break;
                case "right":
                    funcX = x + 60;
                    funcY = y + 5;
                    pinFunction.setAttribute("text-anchor", "start");
                    rotate = 0;
                    break;
                case "top":
                    funcX = x;
                    funcY = y - 40;
                    pinFunction.setAttribute("text-anchor", "middle");
                    rotate = -90;
                    break;
                case "bottom":
                    funcX = x;
                    funcY = y + 40;
                    pinFunction.setAttribute("text-anchor", "middle");
                    rotate = -90;
                    break;
            }
            
            pinFunction.setAttribute("x", funcX);
            pinFunction.setAttribute("y", funcY);
            if (rotate !== 0) {
                pinFunction.setAttribute("transform", `rotate(${rotate}, ${funcX}, ${funcY})`);
            }
            pinFunction.setAttribute("fill", "#333");
            pinFunction.setAttribute("font-size", "12");
            pinFunction.textContent = pin.name;
            svg.appendChild(pinFunction);
        }
        
        // ÊòæÁ§∫Â∑•ÂÖ∑ÊèêÁ§∫
        function showTooltip(event, text) {
            const tooltip = document.getElementById("tooltip");
            tooltip.textContent = text;
            tooltip.style.left = `${event.pageX + 10}px`;
            tooltip.style.top = `${event.pageY + 10}px`;
            tooltip.style.opacity = "1";
        }
        
        // ÈöêËóèÂ∑•ÂÖ∑ÊèêÁ§∫
        function hideTooltip() {
            const tooltip = document.getElementById("tooltip");
            tooltip.style.opacity = "0";
        }

        // ÈÄâÊã©ÂºïËÑö
        function selectPin(pinId) {
            // ÁßªÈô§‰πãÂâçÈÄâ‰∏≠ÁöÑÂºïËÑöÈ´ò‰∫Æ
            document.querySelectorAll('.pin-circle').forEach(pin => {
                pin.setAttribute("stroke-width", "1");
                pin.removeAttribute("filter");
            });
            
            // È´ò‰∫ÆÂΩìÂâçÈÄâ‰∏≠ÁöÑÂºïËÑö
            const pinElement = document.querySelector(`.pin-circle[data-id="${pinId}"]`);
            if (pinElement) {
                pinElement.setAttribute("stroke-width", "3");
                pinElement.setAttribute("stroke", "white");
                // ÂàõÂª∫ÂèëÂÖâÊïàÊûú
                const svgNS = "http://www.w3.org/2000/svg";
                const defs = document.querySelector("#chipSvg defs") || document.createElementNS(svgNS, "defs");
                if (!document.querySelector("#chipSvg defs")) {
                    document.getElementById("chipSvg").appendChild(defs);
                }
                
                if (!document.getElementById("glowFilter")) {
                    const filter = document.createElementNS(svgNS, "filter");
                    filter.setAttribute("id", "glowFilter");
                    filter.setAttribute("x", "-50%");
                    filter.setAttribute("y", "-50%");
                    filter.setAttribute("width", "200%");
                    filter.setAttribute("height", "200%");
                    
                    const feGaussianBlur = document.createElementNS(svgNS, "feGaussianBlur");
                    feGaussianBlur.setAttribute("stdDeviation", "2");
                    feGaussianBlur.setAttribute("result", "blur");
                    
                    const feComposite = document.createElementNS(svgNS, "feComposite");
                    feComposite.setAttribute("in", "SourceGraphic");
                    feComposite.setAttribute("in2", "blur");
                    feComposite.setAttribute("operator", "over");
                    
                    filter.appendChild(feGaussianBlur);
                    filter.appendChild(feComposite);
                    defs.appendChild(filter);
                }
                
                pinElement.setAttribute("filter", "url(#glowFilter)");
            }
            
            // ÊòæÁ§∫ÂºïËÑöËØ¶ÊÉÖ
            displayPinInfo(pinId);
        }

        // ÊòæÁ§∫ÂºïËÑö‰ø°ÊÅØ
        function displayPinInfo(pinId) {
            const pin = pins.find(p => p.id === pinId);
            if (!pin) return;
            
            const infoContent = document.getElementById('pinInfoContent');
            
            let pinTypeDisplay = '';
            if (pin.type === 'power') {
                pinTypeDisplay = '<span class="pin-type power">ÁîµÊ∫ê</span>';
            } else if (pin.type === 'ground' && pin.defaultFunction === 'GND') {
                pinTypeDisplay = '<span class="pin-type ground">Êé•Âú∞</span>';
            } else if (pin.type === 'special') {
                pinTypeDisplay = '<span class="pin-type special">ÁâπÊÆä</span>';
            } else {
                pinTypeDisplay = '<span class="pin-type io">IO</span>';
            }
            
            let configStatus = '';
            if (pinConfigurations[pinId]) {
                configStatus = `<div class="config-status">
                    <span class="label">ÂΩìÂâçÈÖçÁΩÆ:</span> ${pinConfigurations[pinId]}
                </div>`;
            }
            
            // ÂàõÂª∫ÂäüËÉΩÈÄâÊã©‰∏ãÊãâËèúÂçï
            let functionSelector = '';
            if (pinFunctions[pin.name]) {
                functionSelector = `
                <div class="function-selector">
                    <label for="function-select">ÈÄâÊã©ÂäüËÉΩ:</label>
                    <select id="function-select" onchange="updatePinFunction(${pin.id}, this.value)">
                        <option value="">-- ËØ∑ÈÄâÊã©ÂäüËÉΩ --</option>
                        ${pinFunctions[pin.name].map(func => 
                            `<option value="${func}" ${pinConfigurations[pinId] === func ? 'selected' : ''}>${func}</option>`
                        ).join('')}
                    </select>
                </div>`;
            }
            
            // Ê∑ªÂä†ËØÑËÆ∫Âå∫Âüü
            const currentComment = pinComments[pinId] || '';
            const commentSection = `
                <div class="comments-section">
                    <h3>ÂºïËÑöËØÑËÆ∫:</h3>
                    <textarea id="pinComment" placeholder="Ê∑ªÂä†ÂÖ≥‰∫éÊ≠§ÂºïËÑöÈÖçÁΩÆÁöÑÂ§áÊ≥®„ÄÅÂéüÂõ†ÊàñÁî®ÈÄî..." oninput="updatePinComment(${pinId}, this.value)">${currentComment}</textarea>
                    <p class="config-notes">Ê∑ªÂä†ÁöÑËØÑËÆ∫Â∞ÜÈöèÈÖçÁΩÆ‰∏ÄËµ∑‰øùÂ≠ò</p>
                </div>
            `;
            
            infoContent.innerHTML = `
                <div class="pin-detail">
                    <h3>${pinTypeDisplay} ÂºïËÑö ${pin.id} (${pin.name})</h3>
                    <p><span class="label">ÂºïËÑöÂêçÁß∞:</span> ${pin.name}</p>
                    <p><span class="label">ÈªòËÆ§ÂäüËÉΩ:</span> ${pin.defaultFunction}</p>
                    ${configStatus}
                    ${functionSelector}
                    ${commentSection}
                    <div class="button-group">
                        <button onclick="configurePin(${pin.id})">ÈÖçÁΩÆ‰∏∫ÈªòËÆ§ÂäüËÉΩ</button>
                        <button onclick="clearPinConfiguration(${pin.id})">Ê∏ÖÈô§ÈÖçÁΩÆ</button>
                    </div>
                </div>
            `;
        }

        // Êõ¥Êñ∞ÂºïËÑöËØÑËÆ∫
        function updatePinComment(pinId, comment) {
            pinComments[pinId] = comment;
        }

        // Êõ¥Êñ∞ÂºïËÑöÂäüËÉΩ
        function updatePinFunction(pinId, functionName) {
            if (!functionName) return;
            
            // Êõ¥Êñ∞ÈÖçÁΩÆÁä∂ÊÄÅ
            pinConfigurations[pinId] = functionName;
            
            // Êõ¥Êñ∞ÂºïËÑöÈ¢úËâ≤
            const pinElement = document.querySelector(`.pin-circle[data-id="${pinId}"]`);
            if (pinElement) {
                pinElement.setAttribute("fill", "var(--pin-configured-color)");
            }
            
            // Êõ¥Êñ∞‰ø°ÊÅØÈù¢Êùø
            displayPinInfo(pinId);
        }

        // ÈÖçÁΩÆÂºïËÑö
        function configurePin(pinId) {
            const pin = pins.find(p => p.id === pinId);
            if (!pin) return;
            
            // Êõ¥Êñ∞ÈÖçÁΩÆÁä∂ÊÄÅ
            pinConfigurations[pinId] = pin.defaultFunction;
            
            // Êõ¥Êñ∞ÂºïËÑöÈ¢úËâ≤
            const pinElement = document.querySelector(`.pin-circle[data-id="${pinId}"]`);
            if (pinElement) {
                pinElement.setAttribute("fill", "var(--pin-configured-color)");
            }
            
            // Êõ¥Êñ∞‰ø°ÊÅØÈù¢Êùø
            displayPinInfo(pinId);
        }

        // Ê∏ÖÈô§ÂºïËÑöÈÖçÁΩÆ
        function clearPinConfiguration(pinId) {
            const pin = pins.find(p => p.id === pinId);
            if (!pin) return;
            
            // Âà†Èô§ÈÖçÁΩÆ
            delete pinConfigurations[pinId];
            
            // ÊÅ¢Â§çÂºïËÑöÈ¢úËâ≤
            const pinElement = document.querySelector(`.pin-circle[data-id="${pinId}"]`);
            if (pinElement) {
                let pinColor;
                if (pin.type === 'power') {
                    pinColor = '#ff5252'; // Á∫¢Ëâ≤
                } else if (pin.type === 'ground' && pin.defaultFunction === 'GND') {
                    pinColor = '#2196F3'; // ËìùËâ≤
                } else if (pin.type === 'special') {
                    pinColor = '#E040FB'; // Á¥´Ëâ≤
                } else {
                    pinColor = '#7a7a7a'; // ÁÅ∞Ëâ≤
                }
                pinElement.setAttribute("fill", pinColor);
            }
            
            // Êõ¥Êñ∞‰ø°ÊÅØÈù¢Êùø
            displayPinInfo(pinId);
        }

        // Ê∏ÖÈô§ÊâÄÊúâÈÖçÁΩÆ
        function clearAllConfigurations() {
            if (confirm("Á°ÆÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÈÖçÁΩÆÂíåËØÑËÆ∫ÂêóÔºü")) {
                for (const pinId in pinConfigurations) {
                    clearPinConfiguration(parseInt(pinId));
                }
                pinComments = {};
                projectNotes = "";
                document.getElementById("projectNotes").value = "";
            }
        }

        // ÊêúÁ¥¢ÂºïËÑö
        function searchPins() {
            const searchTerm = document.getElementById('searchPin').value.toLowerCase();
            
            if (!searchTerm) {
                document.querySelectorAll('.pin-circle').forEach(pin => {
                    pin.style.opacity = '1';
                });
                return;
            }
            
            document.querySelectorAll('.pin-circle').forEach(pin => {
                const pinId = parseInt(pin.getAttribute('data-id'));
                const pinName = pin.getAttribute('data-name');
                const pinData = pins.find(p => p.id === pinId);
                
                if (pinId.toString().includes(searchTerm) || 
                    pinName.toLowerCase().includes(searchTerm) ||
                    pinData.defaultFunction.toLowerCase().includes(searchTerm) ||
                    pinData.capabilities.some(c => c.toLowerCase().includes(searchTerm))) {
                    pin.style.opacity = '1';
                } else {
                    pin.style.opacity = '0.3';
                }
            });
        }

        // ÂØºÂá∫ÈÖçÁΩÆÂà∞JSONÊñá‰ª∂
        function exportConfig() {
            // ÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´ÂΩìÂâçÈÖçÁΩÆÂíåËØÑËÆ∫ÁöÑÂØπË±°
            const configData = {
                date: new Date().toISOString(),
                pinConfigurations: pinConfigurations,
                pinComments: pinComments,
                projectNotes: projectNotes,
                chipType: "ESP32-S3"
            };
            
            // ËΩ¨Êç¢‰∏∫JSONÂ≠óÁ¨¶‰∏≤
            const jsonStr = JSON.stringify(configData, null, 2);
            
            // ÂàõÂª∫BlobÂØπË±°
            const blob = new Blob([jsonStr], { type: 'application/json' });
            
            // ÂàõÂª∫‰∏ãËΩΩÈìæÊé•
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ESP32-S3-config-${new Date().toISOString().slice(0,10)}.json`;
            
            // Ê®°ÊãüÁÇπÂáª‰∏ãËΩΩ
            document.body.appendChild(a);
            a.click();
            
            // Ê∏ÖÁêÜ
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 0);
            
            // ÊèêÁ§∫Áî®Êà∑
            alert('ÈÖçÁΩÆÂíåËØÑËÆ∫Â∑≤ÂØºÂá∫‰∏∫JSONÊñá‰ª∂!');
        }

        // Â§ÑÁêÜÊñá‰ª∂ÈÄâÊã©
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const configData = JSON.parse(e.target.result);
                    
                    // Ê£ÄÊü•Êï∞ÊçÆÊ†ºÂºèÊòØÂê¶Ê≠£Á°Æ
                    if (!configData.pinConfigurations || !configData.chipType) {
                        throw new Error('ÈÖçÁΩÆÊñá‰ª∂Ê†ºÂºè‰∏çÊ≠£Á°Æ');
                    }
                    
                    // Á°ÆËÆ§ËäØÁâáÁ±ªÂûã
                    if (configData.chipType !== "ESP32-S3") {
                        if (!confirm(`Ë≠¶Âëä: ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑËäØÁâáÁ±ªÂûã (${configData.chipType}) ‰∏éÂΩìÂâçËäØÁâá (ESP32-S3) ‰∏çÂåπÈÖç„ÄÇÁªßÁª≠ÂØºÂÖ•ÂèØËÉΩ‰ºöÂØºËá¥ÈîôËØØÈÖçÁΩÆ„ÄÇÊòØÂê¶ÁªßÁª≠?`)) {
                            return;
                        }
                    }
                    
                    // ÂØºÂÖ•ÈÖçÁΩÆÂâçÊ∏ÖÈô§ÂΩìÂâçÈÖçÁΩÆ
                    clearAllConfigurations();
                    
                    // ÂØºÂÖ•Êñ∞ÈÖçÁΩÆ
                    pinConfigurations = configData.pinConfigurations;
                    
                    // ÂØºÂÖ•ËØÑËÆ∫ÂíåÁ¨îËÆ∞ÔºàÂ¶ÇÊûúÊúâÔºâ
                    if (configData.pinComments) {
                        pinComments = configData.pinComments;
                    }
                    
                    if (configData.projectNotes) {
                        projectNotes = configData.projectNotes;
                        document.getElementById("projectNotes").value = projectNotes;
                    }
                    
                    // Êõ¥Êñ∞ÊâÄÊúâÂºïËÑöÁöÑÊòæÁ§∫
                    updateAllPinColors();
                    
                    alert('ÈÖçÁΩÆÂíåËØÑËÆ∫Â∑≤ÊàêÂäüÂØºÂÖ•!');
                    
                } catch (error) {
                    alert(`ÂØºÂÖ•ÈÖçÁΩÆÂ§±Ë¥•: ${error.message}`);
                }
                
                // ÈáçÁΩÆÊñá‰ª∂ËæìÂÖ•ÔºåÂÖÅËÆ∏ÂÜçÊ¨°ÈÄâÊã©Âêå‰∏ÄÊñá‰ª∂
                event.target.value = '';
            };
            
            reader.readAsText(file);
        }

        // Êõ¥Êñ∞ÊâÄÊúâÂºïËÑöÁöÑÈ¢úËâ≤
        function updateAllPinColors() {
            // È¶ñÂÖàÈáçÁΩÆÊâÄÊúâÂºïËÑö‰∏∫ÈªòËÆ§È¢úËâ≤
            document.querySelectorAll('.pin-circle').forEach(pinElement => {
                const pinId = parseInt(pinElement.getAttribute('data-id'));
                const pin = pins.find(p => p.id === pinId);
                
                let pinColor;
                if (pin.type === 'power') {
                    pinColor = '#ff5252'; // Á∫¢Ëâ≤
                } else if (pin.type === 'ground' && pin.defaultFunction === 'GND') {
                    pinColor = '#2196F3'; // ËìùËâ≤
                } else if (pin.type === 'special') {
                    pinColor = '#E040FB'; // Á¥´Ëâ≤
                } else {
                    pinColor = '#7a7a7a'; // ÁÅ∞Ëâ≤
                }
                
                // Â¶ÇÊûúÂºïËÑöÂú®ÂØºÂÖ•ÁöÑÈÖçÁΩÆ‰∏≠Ë¢´ÈÖçÁΩÆÔºåÂàôËÆæÁΩÆ‰∏∫ÁªøËâ≤
                if (pinConfigurations[pinId]) {
                    pinColor = 'var(--pin-configured-color)';
                }
                
                pinElement.setAttribute("fill", pinColor);
            });
        }

        // ÂàáÊç¢Ê∑±Ëâ≤Ê®°Âºè
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const icon = document.querySelector('.mode-icon');
            if (document.body.classList.contains('dark-mode')) {
                icon.textContent = '‚òÄÔ∏è';
            } else {
                icon.textContent = 'üåô';
            }
        }

        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            createSvgElements();
        });
    </script>
</body>
</html>